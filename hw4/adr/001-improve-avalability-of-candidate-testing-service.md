**Title**: ADR-001 Улучшаем _availability_ сервиса тестирования кандидатов

**Status**: Accepted

**Context**: На момент принятия решения, сервис тестирования кандидатов выполнял синхронный вызов в сервис начисления бонусов, чтобы начислить или списать бонусы для менеджера, когда кандидат отправлял ответ на задание. Такая реализация провела к ряду проблем:

* Упавший сервис создания заданий или бонусов кладёт всю систему, и кандидаты в учителя не могут выполнять задания.
* Менеджерам иногда начисляются бонусы дважды. Это связано с тем, что, когда кандидаты в учителя отправляют то же самое задание повторно, система тупит.
* Синхронные коммуникации объединяют сервисы в один архитектурный квант, из-за чего у них становятся одинаковые эксплуотационные характеристики. В частности, это приводит к тому, что система плохо масштабируется. Бизнесу нужно сократить расходы на скейлинг сервиса заданий.
* Медленно начисляются бонусы менеджерам, потому что много кандидатов в учителя. Иногда вся система падает и не восстанавливается.

При этом в сервисе тестирования кандидатов не нужны данные из ответа вызова.

**Decision**: Чтобы увеличить доступность функции проходжения задания кандидатом, было принято решение о реализации event-driven коммуникации для уведомления сервиса бонусов об успешном или неуспешном проходжении тестирования кандидатом. Вместо вызова метода API начисления бонусов сервис тестирования будет отправлять сообщения `domain.candidate_testing.task_passed` и `domain.candidate_testing.task_failed`.

**Consequences**: Для выполнения задания кандидатом больше не будет важна _availability_ сервиса начисления бонусов, так как коммуникация для отправки статуса прохождения тестирования будет асинхронной. Так же это повысит _elasticity_ системы бонусов, так как сплески количества пройденных тестов будут сглаживаться брокером сообщений. Отправка бизнес-событий вместо вызова API начисления бонусов позволит уменьшить связанность системы, сервис тестирования не будет знать о бизнес-логике сервиса начисления бонусов, улучшиться _modifiability_.
